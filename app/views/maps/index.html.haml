%script{src: "//maps.google.com/maps/api/js?v=3.18&sensor=false&client=&key=&libraries=geometry&language=&hl=&region="}
%script{src:"//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js"}
%script{src:'//google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.9/src/infobox_packed.js'}

%h1 Farms Near Me

#farmList
  - @nearby_farms.each do |farm|
    .farmListItem
      .field
        = farm.name
      .field
        Address:
        = farm.full_address
      .field
        Distance(miles):
        = farm.distance_from(@my_position).round(2)

.mapContainer
  #map

:javascript
  var mapHandler = initMap();
  //var markers = mapHandler.addMarkers(= raw @nearby_farms.to_json);